<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Admin Dashboard - Dr. Labs</title>
<style>
 body{font-family:Arial,Helvetica,sans-serif;background:linear-gradient(135deg,lightblue,lightgreen);margin:0;padding:16px}
 header{display:flex;justify-content:space-between;align-items:center;background:#007bff;color:#fff;padding:10px;border-radius:8px}
 .container{max-width:980px;margin:18px auto}
 .card{background:#fff;padding:12px;border-radius:8px;margin-bottom:12px}
 input,select,button,textarea{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:1px solid #ccc}
 button{background:#007bff;color:#fff;border:0;padding:8px;border-radius:6px;cursor:pointer}
 .logout{background:#dc3545}
</style>
</head>
<body>
<header>
  <div>Admin Dashboard â€” Dr. Labs</div>
  <div><span id="adminName">Admin</span> <button class="logout" onclick="logout()">Logout</button></div>
</header>

<div class="container">
  <div class="card">
    <h3>Create Agent Credential</h3>
    <input id="agentUsername" placeholder="Username">
    <input id="agentPassword" placeholder="Password">
    <input id="agentFullName" placeholder="Full name">
    <select id="agentRole"><option value="Agent">Agent</option><option value="Admin">Admin</option></select>
    <button onclick="createAgent()">Create Agent</button>
  </div>

  <div class="card">
    <h3>Create Technician</h3>
    <input id="techName" placeholder="Technician Name">
    <input id="techEmp" placeholder="Employee ID">
    <input id="techLoc" placeholder="Location">
    <button onclick="createTechnician()">Create Technician</button>
  </div>

  <div class="card">
    <h3>Create Test</h3>
    <input id="testName" placeholder="Test Name">
    <input id="testCost" placeholder="Cost">
    <input id="testCode" placeholder="Code">
    <button onclick="createTest()">Create Test</button>
  </div>

  <div class="card">
    <h3>Create Package</h3>
    <input id="pkgName" placeholder="Package Name">
    <input id="pkgCost" placeholder="Cost">
    <input id="pkgCode" placeholder="Code">
    <button onclick="createPackage()">Create Package</button>
  </div>

  <div class="card">
    <h3>Create Discount</h3>
    <input id="discVal" placeholder="Discount (e.g. 10%)">
    <button onclick="createDiscount()">Create Discount</button>
  </div>
</div>

<script>
const WEB_APP = 'https://script.google.com/macros/s/AKfycbxP3_J7NBRfkR82U_zqY102D1mhVvXbTXTvW-2L785h4_G4ac61u-SPfx7eZcT6RzKGeQ/exec';
document.getElementById('adminName').innerText = localStorage.getItem('adminName') || 'Admin';

function post(action, params){
  return fetch(WEB_APP + '?action=' + action + '&' + new URLSearchParams(params)).then(r=>r.json());
}

function createAgent(){
  const username = document.getElementById('agentUsername').value.trim();
  const password = document.getElementById('agentPassword').value.trim();
  const name = document.getElementById('agentFullName').value.trim();
  const role = document.getElementById('agentRole').value;
  if(!username||!password||!name) return alert('Fill all fields');
  post('createAgentCredential',{ username, password, name, role }).then(j=> j.success ? alert('Agent created') : alert('Failed: '+(j.error||'unknown')));
}

function createTechnician(){
  const name = document.getElementById('techName').value.trim();
  const empId = document.getElementById('techEmp').value.trim();
  const loc = document.getElementById('techLoc').value.trim();
  if(!name) return alert('Enter name');
  post('createTechnician',{ name, empId, location: loc }).then(j=> j.success ? alert('Technician created') : alert('Failed'));
}

function createTest(){
  const name = document.getElementById('testName').value.trim();
  const cost = document.getElementById('testCost').value.trim();
  const code = document.getElementById('testCode').value.trim();
  if(!name) return alert('Enter test name');
  post('createTest',{ name, cost, code }).then(j=> j.success ? alert('Test added') : alert('Failed'));
}

function createPackage(){
  const name = document.getElementById('pkgName').value.trim();
  const cost = document.getElementById('pkgCost').value.trim();
  const code = document.getElementById('pkgCode').value.trim();
  if(!name) return alert('Enter package name');
  post('createPackage',{ name, cost, code }).then(j=> j.success ? alert('Package added') : alert('Failed'));
}

function createDiscount(){
  const d = document.getElementById('discVal').value.trim();
  if(!d) return alert('Enter discount');
  post('createDiscount',{ discount: d }).then(j=> j.success ? alert('Discount added') : alert('Failed'));
}

function logout(){ localStorage.removeItem('adminName'); location.href='index.html'; }
</script>
</body>
</html>
